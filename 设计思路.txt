设计思路

接口设计
1 查询一个组织名称，要带上上级组织名称，
是否要取组织名称，就用一个参数变量来控制。




http://www.jianshu.com/p/453c6e7ff81c

在设计时的假定前提以及需要到达的效果。
我想这些假定适用于所有的系统设计。
随着我们系统的服务的增多，
每位开发者都要注意自己的程序是否存在单点故障，如果挂了应该怎么恢复、
能不能很好的水平扩展、
对外的接口是否足够高效、
自己管理的数据是否足够安全...... 
多多规范自己的设计，才能开发出高效健壮的程序。


分布式消息系统作为实现分布式系统可扩展、可伸缩性的关键组件，
需要具有高吞吐量、高可用等特点。

而谈到消息系统的设计，就回避不了两个问题：
1.消息的顺序问题
2.消息的重复问题

生产者 - MQServer - 消费者是一对一对一的关系


三、事务消息
支持普通消息，顺序消息，另外还支持事务消息。
转账业务
Bob向Smith转账100块。
+---完整的业务逻辑---+
1锁定Bob账户
2锁定Simth账户
3检查Bob账户是否有100块钱
4Bob账户减去100块
5Simth账户加上100块
6解锁Simth账户
7解锁Bob账户
+---完整的业务逻辑---+
涉及到事务问题
大事务=小事务+异步

锁住账户的目的是我在操作账户时候，别人无法动用此账户


RocketMQ
第一阶段发送Prepared消息时，会拿到消息的地址，
第二阶段执行本地事物，
第三阶段通过第一阶段拿到的地址去访问消息，并修改消息的状态。










