
网络基本概念
http://www.ywnds.com/?cat=26
一、网络基本概念
	21世纪数字化，网络化，信息化的时代
	信息化需要完善的网络传递
	internet，局域网，3g，4g
	媒体互联网，服务互联网，物理互联网构成了未来互联网
	智能互联网

	三网，电信网络，有线电视网络，计算机网络
	电信网络--打电话，电报，传真
	有线电视--电视节目
	计算机网--通话，传数据

	互联网起源美国
	四个主网络节点
	UCLA大学，史坦福研究所，圣巴巴拉大学，犹他州力大学

	交换信息，共享资源，提高系统处理能力

	链接介质 双绞线，光纤，同轴电缆

	网络设备 集线器，网桥，交换机，路由器


二、网络发展的三个阶段
	20世纪60年代：分组交换网
	20世纪80年代：TCP/IP协议网
	20世纪90年代：万维网 www

三、不同类别的网络
	广域网WAN(wide area network)
	城域网MAN(metropolitan area network)
	局域网LAN(local area network)

四、网络拓扑结构
	星型，网，树，总线，环型

五、Internet	
	因特网（Internet）
	个人上网ADSL拨号
	企业专线固定ip地址

	提供上网的因特网提供商ISP(internet service provider)

	网络接入点NAP(network access point)

	分3层
	第一层isp 覆盖国家级别的，高速主干网
	第二层ips 大公司
	第三层 本地isp 用户
	个人用户，校园网

	A用户--B用户通信
	A--本地isp--第二次isp--NAP--第一次isp--NAP--第二次isp--本地isp--B

	电信机房--IPS运营商电信
	网通交房--isp运营商网通
	百度--双线机房（两个出口--电信和网通）
	淘宝--双线机房（两个出口--电信和网通）

	A小区网络--电话线--中心局--isp运营商
	B小区网络--电话线--中心局--isp运营商

六、中国互联网
	最早专用计算机广域网的是铁道部
	1980年计算机联网实验
	1989公用分组交换网CNPAC
	20世纪80年代公安，银行军队有了各自的广域网
	1994接入因特网被世界承认
	1994年CHINANET 启动
	中国高速互连研究实验室NSFnet（北大，清华，中国科学院）在中关村成立


计算机数制转换
一、数制的引入
	十二机制（一年12个月，一打12件）
	六十进制（1小时60分，1分60秒）
	24进制（1天24小时）
	二进制
	八进制
	十进制
	十六进制
二、数制的表示
	十进制decimal number
	二进制 binary number
	八进制 october number
	十六进制 hexadecimal number


三、数制的计算
	十进制逢10进1
	二进制逢2进1
	八进制逢8进1
	十六进制逢16进1

四、进制的转换
	二转十
	八转十
	十六转十
	十转二
	十转八
	十转十六
	八转二
	二转八
	十六转二
	十六转二



网络协议与层次划分
	一、网络协议与标准
		互联网消息传输
		传输数据需要网络协议，就是协议
		协议就是规则
		标准就是同意的规则
		因特网标准化工作
		互联网面向公众
		RFC文档免费下载，用户可以提意见建议
		1992年因特网不再受美国政府管辖，
		国际性因特网协会 ISCO
		ISCO下因特网体系委员会IAB，开发协会
		IAB下有两个工程部门，因特网工程部IETF和因特网研究部IRTF
		ISO -- 国际标准化组织
		ANSI -- 美国国家标准化局
		IEEE -- 电气和电子工程师学会

	网络协议三要素
		语法 --数据和控制信息的结构和格式
		语义 --发何种控制，作出何种响应
		同步 --事件的顺序

	两台主机交换文件
	主机A
	-------
	文件传输模块
	通信服务模块
	网络接入模块

	主机B
	-------
	文件传输模块
	通信服务模块
	网络接入模块

	1文件及文件按传送命令
	2与通信有关的报文
	3网络接口--通信网络--网络接口



网络体系结构
一、网络协议模型体系结构介绍
	应用层
	表示层
	会话层
	传输层
	网络层
	数据链路层
	物理层
	---------
	OSI7层模型

	应用层
	传输层
	网络层
	网络接口层
	-----------
	TCP/IP 4层模型

	应用层
	传输层
	网络层
	数据链路层
	物理层
	-----------
	TCP/IP 5层模型


	应用层 application layer：提供用户接口
	表示层 presentation layer：定义传输信息的语法语义
	会话层 session layer: 建立用户之间回话
	传输层 transport layer：硬件设备防火墙实现网络中用户进程之间数据传输根据port端口
	网络层 network layer：硬件路由器实现数据从原端到目的端
	数据链路层 data link layer：硬件交换机以物理地址mac转发数据
	物理层 physical layer 硬件网卡完成邻居节点原始比特流传输

	二、TCP/IP五层参考模型

	三、数据发送封装和解封装
	发送数据过程
	数据封装--从上层到下层一层层封装
	数据解封装--从底层到高层一层层解封装

	发送方
	------------------------------------------------
	数据DATA-（data）--Application
					 --Presention
					 --Session

	段Segment--（TCP/UDP head--data） --Transport
	包Packet--（IP-header--tcp/udp-header--dada）--network
	帧Frame-- （Data Link-header--IP-header--TCP/UDP-header--Dada--crc）--Data Link
	比特Bit--（1000101010010）--Physicalo
	数据封装在不同的层次对数据打上响应的标识
	-------------------------------------------------------

	接收放
	------------------------------------------------
	数据DATA-（data）--Application
					 --Presention
					 --Session

	段Segment--（TCP/UDP head--data） --Transport
	包Packet--（IP-header--tcp/udp-header--dada）--network
	帧Frame-- （Data Link-header--IP-header--TCP/UDP-header--Dada--crc）--Data Link
	比特Bit--（1000101010010）--Physicalo
	数据解封装过程是在不同的层次怼数据去掉响应的标识
	-------------------------------------------------------

	发送方：发数据过程
	1应用层--发http请求--封装http报文--丢下层
	2传输层--接收应用层数据包--封装tcp数据包--控制流量窗口，表明协议，设置请求端口80和自己的端口--丢给下层
	3网络层--接收传输层数据报--封装ip数据报--源和目标ip--丢给下层
	4数据链路层--接收网络数据报--封装为帧--设置源mac地址和下一个mac地址，校验数据--丢给下一层
	5物理层--接收数据报--转为二进制--通过比特流在网络传输


	接送方：接收数据过程
	1物理层--接收模拟信号--转数据信号--交给上层
	2数据链路层--接收数据--解封装帧--查看mac地址--校验数据--丢给上层
	3网络层--接收数据包--解封包--查看目标ip是否和自己一致--丢给上层
	4传输层--接收数据包--解封包--查看目标端口80，--检测本地书否有监听端口--把数据丢给http进程
	5应用层--接收http数据报，http程序处理请求并响应


物理层之通信技术
	一、背景
		网络传输底层的几个问题
		底层传输什么东西？信号
		通过什么传输？介质
		介质如何链接？接口

	二、数据通信系统

		pc机--普通电话线--公用电话线--传输数据

		原系统----传输系统----目的系统
		输入信息->源点->输入数据->发送器->发送信号----传输系统----接收信号->接收器->输出数据->终点—>输出信息
		输入文字-pc机-数字比特流-调制解调器-模拟信号-|-公用电话网-|-模拟信号-调制解调器-数字比特流-pc机-显示文字

	三、信号的概念
		1信息，事务存在方式或运动状态，
		2信息表现形式-数值，文字，图形，声音，图像，都是信息的载体
		3信号，信息传递媒介。信号在网络中传输，使信息传递

		通信目的--传消息，文字，语音，图片，视频
		数据是晕死这些消息的实体，数据是实体
		信号是数据的电气电磁表现形式

	四、信号的分类
		1模拟信号 --信号参数--不同频频-在媒体上传输--连续化的物理量（强调连续）
		2数字信号 --不连续的物理量--信号参数不连续变化 电报信号属于数字信号。最常见的数字信号--二进制信号


	五、调制解调器--数据机
		Moderm--Modulator（调制器）---把数据信号转成电话线传输的模拟信号
		Demodulator(解调器)--把模拟信号转成数字信号


	六、信号在传输过程中产生的失真
		1噪声--干扰信号传输
		2衰减--随着传输信号能力减少

	七、数字信号的优势
		1抗干扰能力强 脉冲
		2远距离传输保证质量
		3适应各个通信业务要求

	八、信道
		单工--只有一个方向通信，而没有反方向交互，无线广播，电视
		半双工--发送消息，但不能双方同时发送消息--对讲机
		全双工--双向通信--电话，手机

	九、信道复用技术
		不适用复用技术
		A1--信道--A2
		B1--信道--B2
		C1--信道--C2

		使用复用技术
		ABC--复用--共享信道--封面用--ABC



-------------
物理层之传输媒体
	一、导向传输介质
		双绞线（Twist-pair）（网线）
	   --传输介质，模拟信号，数字信号都可以传输
	   --共8根。两两胶合
	   --屏蔽双绞线STP/非屏蔽双绞线UTP

		管教号 用途 颜色
		1	    发送+ 	白绿
		2		发送- 	绿
		3		接收+ 	白橙
		4 		不被使用 	蓝
		5		不被使用 	白蓝
		6 		接收- 		橙
		7 		不被使用 	白棕
		8 		不被使用 	棕


		同轴电缆
			大锅天线，的线
			绝缘体保护套
			半导体屏蔽层
			绝缘体
			内导体

		光纤
			光纤通信利用光导纤维传递脉冲进行通信
			光脉冲相当于1，没有光脉冲相当于0
			传输带宽高，距离远，抗干扰强



	二、非导向传输媒体
		非导向传输媒体--无线电波的传输不需要物理介质
		短波通信（高频通信）
		无线电微波通信
		卫星通信就是微波通信

	三、接口
		RJ-45接口--水晶头
		光纤接口--sc接头和接口
		信息插座--RJ-45插座模块--信息插座面板

	四、网线制作
	五、信息插座制作
	六、布线系统


数据链路层
	数据链路是计算机网络的底层
	数据链路使用信道
	1点到点信道--1对1
	2广播信道--1对多

	广播信道需要
	共享信道协议
	来协调主机数据发送

一、链路与数据链路
	链路 link 点到点
	数据链路 dada link +通讯协议 控制数据传输，软件+硬件=数据链路
	适配器（网卡）实现协议的硬件和软件
	适配器包括了数据链路层和物理层两个功能
	点到点的数据链路层PUD(协议数据单元)--帧

	数据链路层
			  把网络层的数据--构成数据帧--通过网线发送到链路上
			  把接收的数据提取到网络层处理

	网络协议层的数据单元就是IP数据报（数据报，分组，包）

	封装成帧，透明传输，差错校验


二、局域网的数据链路层
	局域网有较高的数据率，较低时延，较小误码率
	局域网按网络拓扑分类
		总线网
		播反网
		树形网
		环形网
		星形网

三、以太网--局域网的专业术语

四、网络接口卡
	网卡NIC(network ineterface card)--网络接口卡
	处理器cpu
	存储器（RAM/ROM）
	网卡与计算机通讯--计算机主板I/O并行传输的
	网卡接收发送各种帧不使用计算机cpu
	网卡接收帧--交给协议栈的网络层
	计算机发送数据包--交给网卡，封装成帧发生局域网
	计算机硬件的mac地址在网卡的ROM
	计算机的软件地址IP在计算机的存储器中


五、集线器时代的星形拓扑
	1表面上看在局域网是一个星型网
	2有很多接口，网线接口RJ-45插头
	3工作在物理层-转发数据
	4可以发生广播消息

六、以太网MAC层
	mac地址--物理地址--地址在mac帧中也是数据链路的帧格式
	mac地址是网卡的物理地址
	mac地址全球唯一
	mac地址位二进制组成，分为6段，用16进制表示
	前24位是生产厂商IEEE申请厂商标号
	后24位网络接口卡序列号
	mac地址第8位=0时，mac为单播地址
	mac地址第8位=1时，mac为组播mac地址
	单播地址，第8位=0
	组播地址，一个逻辑地址，用来表示一组接收者，不是一个接收者
	mac地址在网卡的rom中
	windows 命令 ipconfig /all

	mac帧
	单播帧(unicast)--一对一
	广播帧(broadcast)--一对全部
	组播帧(multicast)--一对多

七、MAC帧的格式
	两种标准
	DIX Ethernet v2
	IEEE 的802.3	

	以太网数据包Ethernet v2的帧（http，ftp，smtp，pop3等应用）
	交换机的BPDU（桥协议数据单元）数据包是用IEEE802.3的帧
	VLAN Trunk协议802.1Q和Cisco的CDP（思科发现协议）

	利用Sniffer等协议分析工具抓包--解码--查看分析数据


八、网桥设备
	网桥工作在数据链路层
	根据mac帧的目的地址对收到的帧进行转发过滤


	网桥和交换机有啥去呗
	你现在分的清楚，公网和私网吗 
	我说的是地址访问 
	地址范围--网段的划分
	网络划分5个网段


	网桥是一根线
	交换机不是
	网线的话只能端到端啊，只能两台互联
	三层交换，很多设备
	网桥是  在交换机出来之前的设备


	网桥链接局域网不同的网段，两台pc发消息，
	如果在同一个网段，不用通过网桥，
	如果不在同一个网段，需要经过网桥

	集线器：工作在物理层，用于构成冲突域（广播域）
	网桥/交换机：工作在数据链路层，用于链接不同的网络。
				网桥/交换机会在自身储存硬件端口与mac地址的映射关系
				一般使用网桥/交换机隔离LAN。简单来说
				网桥可以看作一个端口数少的交换机

	路由器：工作在网络层。用户链接不同的网络，进行分组转发。区别在与
			网桥/交换机根据mac转发，路由器根据ip进行转发。


九、以太网交换机
	交换机工作在数据链路层
	交换机实质是一个多接口的网桥
	一淘网交换机每个接口直接与单个pc或者另一个集线器相连接



对比互联网规模
服务器规模 400+
点睛也就40+
开发语言这里用python，点睛不用；
使用什么云产品
这里用很多云产品，点睛仅仅用 ECS；
有 大流量大平台优先
维护过200+ 或 500+服务器

大流量
百度--日均 千万PV的优先 
一个PV就是一个页面入口
就是一个网页入口，而不是一个资源
一个页面的入口是一个PV， 一个资源不是
一个PV就类似  一个html, 一个资源就是css,js,png
-------------
网络层之IP地址应用
数据链路层的标识是MAC地址
	网络层的标识是ip地址
	因特网中ip地址可以标识一个主机（或路由器）
	全世界范围唯一的32位标识符
	ipv4=2的32次方
	ipv6地址

IPV4讲解
IPV4地址分类：IP地址分为A、B、C、D、E这五类
A类地址--范围1--126，子网掩码255.0.0.0
		全球A类地址有126个，
		每个A类地址主机数2的24次方
		主机地址不能是全位0或1，所以
		A类主机数是2的24次方-2

B类地址--范围128-191
		 子网掩码-255.255.0.0
		 B类主机2的16次方 -2个

c类地址--范围192-223
		 子网掩码-255.255.255.0
		 B类主机2的8次方 -2个


D类地址：组播地址
E类地址：科学研究
127.0.0.1又称为本机回环地址


私网地址分类

A类：10.0.0.0——-10.255.255.255适用于大型网络，默认子网掩码为255.0.0.0或/8
B类：172.16.0.0—–172.31.255.255适用于中型网络，默认子网掩码为255.255.0.0或/16
C类：192.168.0.0—–192.168.255.255适用于小型网络，默认子网掩码为255.255.255.0或/24
10.0.0.0 主机位 三零     
172.16.0.0  两个零  
192.16.1.0 一个零 

一个字节8位

8 = 255 = 11111111  前八位是1
16 = 255.255 = 1111111111111111
24 = 255.255.255 = 11111111.11111111.11111111
	8个1在二进制转10十进制后 就是255
	以8位为一个区分点，点分十进制

百度一下
	点分十进制--（Dotted Decimal Notation）
	点分（点式）十进制表示法，是IPv4的IP地址标识方法
	IPv4中用四个字节表示一个IP地址
	每个字节按照十进制表示为0~255。
	点分十进制就是用4个从0~255的数字，
	来表示一个IP地址。

192.168.1.0 可用地址为253
172.16.0.0 253*253 个地址



子网规划
子网划分 是根据 子网掩码  划分的
子网掩码是你规划  ip地址的个数使用的    自己定义     
子网掩码就是  区分不同网络

就类似切片，将一个大的数据，切分成多个分片；
子网是将一个大的网络切割成多个小的网络 ；
公司有800人，子网数和主机数杂计算呢
主机位借网络位
IP分为  网络位，主机位
通过子网掩码计算网段--进行网络规划
-------------


网络层之IP协议
一、网络层
	数据链路层以mac帧和局域网交换机
	网络层通过路由器

	网络的协议
		网际协议ip是tcp/ip协议，因特网标准协议
		网地址解析协议ARP
		你地址解析协议RARP
		网际控制报文协议ICMP
		网际组管理协议IGMP

	网络层路由选择协议
		内部网关协议RIP,OSPF
		外部网关协议BGP

	虚拟专用网VPN
	网络地址转换NAT

二、ARP和RARP（DHCP协议）
	ip协议经过ARP（address resolve protocol）地址解析协议和
	RARP逆地址解析协议

	发送给目标地址ip地址，网络链路上传帧需要找到mac地址
	ARP通过ip地址解析到对方的mac地址
	每个主机上都有一个arp高速缓存
	windows 命令 arp -a 查看arp缓存表
			通过 arp -d 清楚arp缓存表（管理员身份运行）

	（*******）
	局域网A与B通信，先从ARP表找mac地址--写入mac帧（数据）--发送mac帧
	如果没有找到对方的mac地址，A会发广播arp报文获取B的mac地址
	arp广播原理--A发广播--B接收广播，B根据目标ip，知道是发给自己的，就回应A，A缓存B的mac地址
	局域网中其他主机发现目标ip不是自己的，就会废弃arp报文

	RARP和ARP相反，知道mac地址解析出ip地址
	下现在DHCP协议中包含RARP协议的功能

	交换机也正因为ARP协议才不用广播数据包，解决数据安全问题
	广播ARP获取mac地址
	交换机可以通过mac地址一对一发生数据包

三、IP数据包格式　
数据报
字段含义
	Version  版本字段
	Internet Header Length 头长度字段
	Type of Service TOS服务字段
	Total length 总长度
	Identification(fragment ID) 标识符字段
	Flags 标志位
	Fragment OFFset 段便宜字段
	Time-to-Live TTL 生存周期字段
	Protocol 协议字段
	Header Checksum 头部校验和字段
	Source IP ADRESS 源ip地址字段
	Destination IP Address 目标ip地址字段
	Option 可选字段
		loose source routing（松散路由选择）
		strict soutce routing （严格路由选择）
		record route（记忆路由）
		timestamp（时间戳）
		verbose（详细内容）
		padding（填充）
	Data 数据

四、ICMP
	ICMP报文座位ip层数据报的数据+报头首部

	ICMP分组网间探测ping
		ping www.baidu.com

		windows 命令
		tracert www.baidu.com

五、路由器
	数据链路层--局域网的概念--交换机/网关
	网络层就考虑路由器--路哟其把不同或者相同的局域网进行互联
	路由器--专门的计算机用来互联网进行路由选择

	路由器--链接--交换机--使不同网段的网络链接起来
	路由表

-------------

传输层之协议概述
一、进程之间的通信
	网络核心--路由器--用到下三层的功能
	数据链路--交换机--用到下二层
	传输层--4层交换--端到端，点到点，进程和进程的交换

	两个主机的进程通,两个主机的应用相互通信

	ip协议把数据送到目标地址，传输层才是端到端的通信

	网络层是主机与主机之间的通信
	传输层上升到进程与进程之间的通信，端到端的通信

	传输层怼保温进行差错检查，
	网络层，ip数据报首部校验和字段

二、传输层协议
	面向连接的TCP（transmission control protocol）传输控制协议和
	无连接的UDP（user datagram protocol）用户数据报协议
	----------
	应用层
	TCP/UDP
	ip
	各种网络接口
	----------
	tcp面向链接的服务，传输数据，建立链接--数据传输结束--释放链接

三、传输层的端口
	主机通过ip来表示
	应用需要端口号来标识
	端口号 protocol port number
	TCP/IP使用16位的端口，（1-65535个端口）
	知道ip能够找到对方的计算机
	知道端口号就能找到对方的应用

	因特网是C/S 客户端/服务器模式

	服务端使用的端口号
	一类叫熟知端口号，数值为0-1023。这些数值可在IANA官网查询
		FTP:21，SSH:22，TELNET:23，SMTP:25，DNS:53，HTTP:80，
		https:443，RDP:3389，SMTP:25，POP3:110，DHCP:67，
		SNMP:161，SNMP(TRAP):162，TFTP:69
	另一类叫登记端口号，数值为1024-49151，
		这类端口号是为没有熟知端口号的应用程序使用的

	客户端使用的端口号
		数值为49152-65535。由于这类端口号仅在客户端进程运行时才动态选择，
		因此又叫做随机端口号。
-------------
传输层之TCP协议
一、TCP协议的特点
	1）可靠面向链接，首先必选建立链接
	2）传输数据安全
	3）端到端，点到点的传输
	4）TCP提全双工通信
	5）面向字节流

二、TCP报文格式
	Source/Dest Port 源/目标端口号字段
	Sequence number 顺序号字段：
	Acknowledgement Number 确认号字段
	Header Length 头部长度字段
	保留 
	标志位字段（U、A、P、R、S、F）
		URG：紧急指针（urgent pointer）有效或无效。

		ACK：说明确认号是否有效；1有效，0无效。

		PSH：推送表示接收方应该尽快将这个报文段交给应用层不能再缓冲中停留，内核优先处理的报文。

		RST：重建连接。

		SYN：发起一个连接。

		FIN：释放一个连接。
	Windows size 窗口大小字段
	Tcp checksum TCP 校验和字段
	Urgent Pointer 紧急指针字段
	Options 选项字段
	Data 数据段


三、UDP数据段格式
	源/目标端口号字段
	长度字段：
	校验和字段


四、套接字
	TCP连接的端点叫做套接字（socket）
	端口号拼接到IP地址即构成了套接字 ip+port=socket

五、TCP的连接建立
成功建立链接需三次握手
建立来链接之后才可以发送数据
释放链接

建立链接--三次握手--成功建立链接--发送数据--释放链接



七、TCP有限状态机

	状态解释：

	CLOSED：关闭状态。

	LISTEN：侦听来自远方的TCP端口的连接请求。

	SYN-SENT：再发送连接请求后等待匹配的连接请求。

	SYN-RECEIVED：再收到和发送一个连接请求后等待对方对连接请求的确认。

	ESTABLISHED：代表一个打开的连接。

	FIN-WAIT-1：发送FIN之后的状态。

	CLOSING：接收远程TCP连接中断的确认。

	FIN-WAIT-2：接收到远程TCP连接中断的请求。

	TIME-WAIT：等待足够的时间2MSL以确保远程TCP接收到连接中断请求的确认。

	CLOSE-WAIT：等待本地用户发的连接中断确认到连接中断请求。

	LAST-ACK：等待原来的发向远程TCP的连接中断请求的确认。

-------------
TCP序列号和确认号详解

读懂TCP序列号和确认号在的变化趋势，
可以帮助我们学习TCP协议以及排查通讯故障，
如通过查看序列号和确认号可以确定数据传输是否乱序




-------------



















